<project basedir="." xmlns:sf="antlib:com.salesforce">
    
   <!-- *************************************************************** -->
  <!--   Properties for Salesforce ANT targets                         -->
  <!-- *************************************************************** -->
  <property file="build.properties"/>
  <property environment="env"/>
<!-- ***************************************************************************** -->
  <!-- ANT Import Files for invoking APEX inside ANT Scripts                         -->
  <!-- ***************************************************************************** -->
  <import file="${basedir}/lib/package_generator.xml"/>

 <!-- Setting default value for username, password and session id properties to empty string 
         so unset values are treated as empty. Without this, ant expressions such as ${sf.username}
         will be treated literally.
    -->
   
   <condition property="username" value=""> <not> <isset property="username"/> </not> </condition>
   <condition property="password" value=""> <not> <isset property="password"/> </not> </condition>
   <condition property="deployroot" value=""> <not> <isset property="deployroot"/>  </not> </condition>


   

<!--##################################################### Deploy #########################################-->
 
	<target name="deploy" depends="proxy">
	<sf:deploy
			username="${username}"
			password="${password}"
			serverurl="${serverurl}"
			maxPoll="${maxPoll}" 
			deployRoot="${deployroot}"			
			rollbackOnError="true"
			testlevel="NoTestRun" 
			logType="Debugonly" trace="false"/>
  </target>


 <!--##################################################### Set Proxy if Enabled #########################################-->

	<target name="probe-proxy">
   	 <condition property="proxy.enabled">
      	<and>
        <isset property="proxy.host"/>
	<isreachable host="${proxy.host}"/>
      </and>
    </condition>
  	</target>

	<target name="proxy" depends="probe-proxy" if="proxy.enabled">
		<property name="proxy.port" value="${proxy.port}" />

		<setproxy 
		proxyhost="${proxy.host}" 
		proxyport="${proxy.port}" 
		
		/>
	</target> 


</project>
